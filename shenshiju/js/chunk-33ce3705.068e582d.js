(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33ce3705"],{"3fdd":function(e,t,a){},"56cc":function(e,t,a){"use strict";var s=a("3fdd"),i=a.n(s);i.a},7703:function(e,t,a){"use strict";var s=a("8494"),i=a.n(s);i.a},8494:function(e,t,a){},c073:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"surepay"},[a("div",{staticClass:"nav_bar flex"},[a("van-icon",{attrs:{name:"arrow-left"},on:{click:e.go}}),a("span",[e._v("确认支付")])],1),e._m(0),a("div",{staticClass:"addr flex_be",on:{click:function(t){return e.gonewshippingAddr(e.orderaddress)}}},[a("div",{staticClass:"flex_be"},[a("van-icon",{attrs:{name:"location-o"}}),0==e.orderaddress.length?a("span",{on:{click:e.gonewshippingAddr1}},[e._v("请填写收货地址")]):a("div",[a("span",{staticClass:"info",staticStyle:{"margin-bottom":"0.2rem",display:"block"}},[e._v(e._s(e.orderaddress.name)+" "+e._s(e.orderaddress.phone))]),a("div",{staticClass:"flex_cen",staticStyle:{"font-size":"0.25rem"}},[a("span",{staticClass:"express"},[e._v("快递")]),e._v(" "+e._s(e.orderaddress.province)+e._s(e.orderaddress.city)+e._s(e.orderaddress.district)+e._s(e.orderaddress.address)+" ")])])],1),a("van-icon",{attrs:{name:"arrow"}})],1),a("div",{staticStyle:{"padding-bottom":"1rem"}},[a("div",{staticClass:"itemlist flex"},[a("img",{attrs:{src:e.orderdetail.cover,alt:""}}),a("div",[a("p",[e._v(e._s(e.orderdetail.title))]),a("div",{staticClass:"price flex_be",staticStyle:{width:"4.6rem"}},[a("span",[e._v("¥"+e._s(e.orderdetail.price))]),a("van-stepper",{attrs:{theme:"round","button-size":"22",disabled:""},model:{value:e.orderdetail.num,callback:function(t){e.$set(e.orderdetail,"num",t)},expression:"orderdetail.num"}})],1)])]),a("div",{staticClass:"message"},[a("h6",[e._v("买家留言")]),a("van-field",{attrs:{rows:"4",autosize:"",type:"textarea",placeholder:"建议留言前先于商家沟通","show-word-limit":""},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})],1),a("div",{staticClass:"money"},[a("div",{staticClass:"flex_be"},[a("span",[e._v("商品金额")]),a("span",[e._v("¥"+e._s(e.total))])]),e._m(1)])]),a("div",{staticClass:"btn flex_be"},[a("div",[e._v(" 合计： "),a("span",{staticStyle:{}},[e._v(e._s(e.total))])]),a("div",{staticClass:"onsubmit",on:{click:e.gopay}},[e._v("立即付款")])])])},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pickup_type flex_be"},[a("span",[e._v("取货方式")]),a("span",[e._v("快递")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flex_be"},[a("span",[e._v("运费")]),a("span",[e._v("¥0.00")])])}],r=(a("d3b7"),a("5530")),n=a("2f62"),o=a("2ade"),d={components:{},computed:Object(r["a"])({},Object(n["b"])({token:function(e){return e.token},userInfor:function(e){return e.userInfor},navactivechoseid:function(e){return e.navactivechoseid},orderTime:function(e){return e.orderTime}})),data:function(){return{message:"",value:1,orderaddress:[],orderdetail:[],total:0,creatime:"",daoTim:"",msg:"",timer:null,orderid:localStorage.getItem("orderid")}},created:function(){var e=this;console.log(this.$route.query.bid),o["a"].getBlueOrder({uid:this.userInfor.member_id,bid:this.$route.query.bid}).then((function(t){if(2==t.code)return e.$router.push({path:"/login"}),!1;e.orderaddress=t.data.address,e.orderdetail=t.data.goods,e.total=t.data.total,console.log(t,"图纸购买生成订单")})).catch((function(){})).finally((function(){}))},mounted:function(){},methods:{wxrequest:function(){var e=this;o["a"].getwxrequest({out_trade_no:this.orderid}).then((function(t){alert(1==t.code),alert(JSON.stringify(0==t.code)),0==t.code&&(alert(JSON.stringify(t)),e.$router.push({path:"/success",query:{price:e.total}}))}))},wechatPay:function(){var e=this;o["a"].getBluePay({uid:this.userInfor.member_id,bid:this.$route.query.bid,address:this.orderaddress.id}).then((function(t){console.log(t,"支付");var a=t.data.out_trade_no;if(localStorage.setItem("orderid",a),e.wxrequest(),1==t.code)e.$toast(t.message);else if(0==t.code){var s=t.data.apiToay;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:s.appId,timeStamp:s.timeStamp,nonceStr:s.nonceStr,package:s.package,signType:s.signType,paySign:s.paySign,jsApiList:["chooseWXPay"]},(function(t){"get_brand_wcpay_request:ok"==t.err_msg?e.$toast("支付成功"):(e.$toast("支付失败"),e.$router.push({path:"/drawingOrder",query:{navactivechoseid:0}}))}))}})).catch((function(){e.$toast("系统异常,请重新登录"),e.$router.push({path:"/login"})})).finally((function(){}))},gopay:function(){"undefined"==typeof WeixinJSBridge?(this.$toast("支付失败"),document.addEventListener?document.addEventListener("WeixinJSBridgeReady",this.wechatPay,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",this.wechatPay),document.attachEvent("onWeixinJSBridgeReady",this.wechatPay))):this.wechatPay()},go:function(){this.$router.go(-1)},gonewshippingAddr:function(e){console.log(e),this.$router.push({path:"/newshippingAddr",query:{item:e}})},gonewshippingAddr1:function(){this.$router.push({path:"/newshippingAddr"})}},beforeDestroy:function(){clearInterval(this.timer),this.timer=null}},c=d,l=(a("56cc"),a("7703"),a("2877")),u=Object(l["a"])(c,s,i,!1,null,"077295bd",null);t["default"]=u.exports}}]);